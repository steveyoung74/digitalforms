<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risk Assessment & Review | Evelyn Partners Fact Find</title>
    <style>
        :root {
            /* Primary Brand Colours - Evelyn Partners Rebrand */
            --primary: #2D2047;
            --primary-dark: #1E1530;
            --primary-light: #6B3FA0;
            
            /* Secondary Accent Colours */
            --accent-teal: #34675C;
            --accent-coral: #E07065;
            --accent-blue: #5299E0;
            --accent-gold: #C4A35A;
            
            /* Semantic Colours */
            --success: #28a745;
            --success-light: #d4edda;
            --warning: #ffc107;
            --warning-light: #fff3cd;
            --danger: #dc3545;
            
            /* Neutral Grays */
            --gray-50: #f8f9fa;
            --gray-100: #f0f1f3;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-400: #ced4da;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-700: #495057;
            --gray-800: #343a40;
            --gray-900: #212529;
            
            /* UI Properties */
            --border-radius: 8px;
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.1);
            --transition: all 0.2s ease;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--gray-100);
            color: var(--gray-800);
            line-height: 1.6;
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-md);
        }

        .header-top { display: flex; justify-content: space-between; align-items: center; padding: 16px 24px; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .logo { font-size: 20px; font-weight: 600; }
        .type-badge { background: rgba(255,255,255,0.2); padding: 6px 14px; border-radius: 20px; font-size: 13px; font-weight: 500; }
        .header-main { padding: 20px 24px; }
        .journey-title { font-size: 14px; opacity: 0.9; margin-bottom: 4px; }
        .section-title { font-size: 24px; font-weight: 600; margin-bottom: 8px; }
        .section-description { font-size: 14px; opacity: 0.85; }

        .progress-container { background: rgba(0,0,0,0.2); padding: 16px 24px; }
        .progress-label { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 8px; opacity: 0.9; }
        .progress-bar { height: 6px; background: rgba(255,255,255,0.3); border-radius: 3px; overflow: hidden; }
        .progress-fill { height: 100%; background: white; border-radius: 3px; transition: width 0.3s ease; }
        .progress-steps { display: flex; justify-content: space-between; margin-top: 12px; }
        .progress-step { display: flex; flex-direction: column; align-items: center; font-size: 10px; opacity: 0.7; cursor: pointer; flex: 1; }
        .progress-step:hover, .progress-step.active, .progress-step.completed { opacity: 1; }
        .step-dot { width: 12px; height: 12px; border-radius: 50%; background: rgba(255,255,255,0.3); margin-bottom: 4px; }
        .progress-step.active .step-dot { background: white; box-shadow: 0 0 0 3px rgba(255,255,255,0.3); }
        .progress-step.completed .step-dot { background: var(--success); }

        .main-content { max-width: 900px; margin: 0 auto; padding: 24px; }

        .save-status-bar { background: white; border-radius: var(--border-radius); padding: 12px 20px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: var(--shadow-sm); }
        .save-status { display: flex; align-items: center; gap: 8px; font-size: 13px; color: var(--gray-600); }
        .save-status-icon { width: 8px; height: 8px; border-radius: 50%; background: var(--gray-400); }
        .save-status-icon.saved { background: var(--success); }
        .save-status-icon.saving { background: var(--warning); animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .btn-save { background: var(--gray-100); color: var(--gray-700); border: none; padding: 8px 16px; border-radius: 6px; font-size: 13px; font-weight: 500; cursor: pointer; }
        .btn-save:hover { background: var(--gray-200); }

        .section-card { background: white; border-radius: var(--border-radius); margin-bottom: 16px; box-shadow: var(--shadow-sm); overflow: hidden; border: 1px solid var(--gray-200); }
        .section-header { padding: 20px 24px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border-bottom: 1px solid transparent; }
        .section-card.expanded .section-header { border-bottom-color: var(--gray-200); }
        .section-header:hover { background: var(--gray-50); }
        .section-header-left { display: flex; align-items: center; gap: 16px; }
        .section-number { width: 32px; height: 32px; border-radius: 50%; background: var(--gray-100); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; color: var(--gray-600); }
        .section-card.completed .section-number { background: var(--success-light); color: var(--success); }
        .section-info h3 { font-size: 16px; font-weight: 600; color: var(--gray-800); margin-bottom: 2px; }
        .section-info p { font-size: 13px; color: var(--gray-500); }
        .status-badge { font-size: 12px; padding: 4px 10px; border-radius: 12px; font-weight: 500; }
        .status-badge.pending { background: var(--gray-100); color: var(--gray-600); }
        .status-badge.completed { background: var(--success-light); color: var(--success); }
        .toggle-icon { font-size: 20px; color: var(--gray-400); transition: transform 0.2s ease; }
        .section-card.expanded .toggle-icon { transform: rotate(180deg); }
        .section-content { display: none; padding: 24px; background: var(--gray-50); }
        .section-card.expanded .section-content { display: block; }

        .applicant-toggle { display: flex; gap: 8px; margin-bottom: 24px; padding: 4px; background: var(--gray-100); border-radius: 8px; width: fit-content; }
        .applicant-btn { padding: 10px 20px; border: none; background: transparent; border-radius: 6px; font-size: 14px; font-weight: 500; color: var(--gray-600); cursor: pointer; }
        .applicant-btn.active { background: white; color: var(--primary); box-shadow: var(--shadow-sm); }
        .applicant-form { display: none; }
        .applicant-form.active { display: block; }

        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 20px; }
        .form-group.full-width { grid-column: 1 / -1; }
        .form-label { display: block; font-size: 14px; font-weight: 500; color: var(--gray-700); margin-bottom: 6px; }
        .form-label .required { color: var(--danger); }
        .form-input, .form-select, .form-textarea { width: 100%; padding: 12px 14px; border: 1px solid var(--gray-300); border-radius: 6px; font-size: 15px; color: var(--gray-800); background: white; }
        .form-input:focus, .form-select:focus, .form-textarea:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(45, 32, 71, 0.15); }
        .form-textarea { min-height: 100px; resize: vertical; }
        .form-hint { font-size: 12px; color: var(--gray-500); margin-top: 4px; }

        .option-group { display: flex; flex-wrap: wrap; gap: 12px; }
        .option-item { position: relative; }
        .option-item input { position: absolute; opacity: 0; }
        .option-item label { display: block; padding: 12px 20px; background: white; border: 1px solid var(--gray-300); border-radius: 6px; cursor: pointer; font-size: 14px; }
        .option-item input:checked + label { background: var(--primary); color: white; border-color: var(--primary); }
        .option-item label:hover { border-color: var(--primary); }

        .section-actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--gray-200); }
        .btn { padding: 12px 24px; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; border: none; }
        .btn-secondary { background: white; color: var(--gray-700); border: 1px solid var(--gray-300); }
        .btn-secondary:hover { background: var(--gray-50); }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: var(--primary-dark); }
        .btn-success { background: var(--success); color: white; }
        .btn-success:hover { background: #218838; }

        .page-navigation { display: flex; justify-content: space-between; align-items: center; margin-top: 32px; padding: 24px; background: white; border-radius: var(--border-radius); box-shadow: var(--shadow-sm); }
        .nav-btn { display: flex; align-items: center; gap: 8px; padding: 14px 28px; border-radius: 6px; font-size: 15px; font-weight: 500; cursor: pointer; border: none; text-decoration: none; }
        .nav-btn-prev { background: var(--gray-100); color: var(--gray-700); }
        .nav-btn-prev:hover { background: var(--gray-200); }
        .nav-btn-next { background: var(--success); color: white; }
        .nav-btn-next:hover { background: #218838; }
        .nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }

        .info-box { background: #e7f3ff; border: 1px solid #b3d7ff; border-radius: 6px; padding: 16px; margin-bottom: 20px; }
        .info-box p { font-size: 14px; color: #004085; }

        /* Oxford Risk Question Styles */
        .risk-question { background: white; border: 1px solid var(--gray-200); border-radius: 8px; padding: 20px; margin-bottom: 16px; }
        .risk-question h4 { font-size: 15px; font-weight: 600; color: var(--gray-800); margin-bottom: 16px; }
        .risk-options { display: grid; gap: 8px; }
        .risk-option { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: var(--gray-50); border-radius: 6px; cursor: pointer; transition: var(--transition); }
        .risk-option:hover { background: var(--gray-100); }
        .risk-option input { width: 18px; height: 18px; }
        .risk-option.selected { background: rgba(45, 32, 71, 0.15); border: 1px solid var(--primary); }
        .risk-option label { cursor: pointer; font-size: 14px; color: var(--gray-700); }

        /* Bank Details */
        .bank-card { background: white; border: 1px solid var(--gray-200); border-radius: 8px; padding: 20px; }
        .bank-icon { font-size: 32px; margin-bottom: 16px; }

        /* Review Summary */
        .review-section { background: white; border: 1px solid var(--gray-200); border-radius: 8px; margin-bottom: 16px; overflow: hidden; }
        .review-header { padding: 16px 20px; background: var(--gray-50); border-bottom: 1px solid var(--gray-200); display: flex; justify-content: space-between; align-items: center; }
        .review-title { font-weight: 600; color: var(--gray-800); }
        .review-status { display: flex; align-items: center; gap: 8px; font-size: 13px; }
        .review-status.complete { color: var(--success); }
        .review-status.incomplete { color: var(--danger); }
        .review-content { padding: 16px 20px; }
        .review-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid var(--gray-100); }
        .review-item:last-child { border-bottom: none; }
        .review-label { color: var(--gray-500); font-size: 13px; }
        .review-value { color: var(--gray-800); font-size: 14px; font-weight: 500; }
        .btn-edit { background: none; border: none; color: var(--primary); font-size: 13px; cursor: pointer; }

        /* Declaration */
        .declaration-section { background: var(--warning-light); border: 1px solid var(--warning); border-radius: 8px; padding: 24px; margin-top: 24px; }
        .declaration-section h3 { font-size: 16px; font-weight: 600; color: #856404; margin-bottom: 16px; }
        .declaration-text { font-size: 14px; color: #856404; margin-bottom: 20px; line-height: 1.7; }
        .declaration-check { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 12px; }
        .declaration-check input { width: 20px; height: 20px; margin-top: 2px; }
        .declaration-check label { font-size: 14px; color: var(--gray-700); cursor: pointer; }

        /* Completion Banner */
        .completion-banner { background: linear-gradient(135deg, var(--success) 0%, #1e7e34 100%); color: white; border-radius: 12px; padding: 32px; text-align: center; margin-top: 24px; display: none; }
        .completion-banner.visible { display: block; }
        .completion-icon { font-size: 48px; margin-bottom: 16px; }
        .completion-banner h2 { font-size: 24px; margin-bottom: 8px; }
        .completion-banner p { opacity: 0.9; margin-bottom: 24px; }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .header { transition: transform 0.3s ease; }
            .header.header-hidden { transform: translateY(-100%); }
            .header-top { flex-direction: row; padding: 10px 16px; gap: 8px; }
            .logo { font-size: 16px; }
            .type-badge { padding: 4px 10px; font-size: 11px; }
            .header-main { padding: 12px 16px; }
            .journey-title { font-size: 12px; margin-bottom: 2px; }
            .section-title { font-size: 18px; margin-bottom: 4px; }
            .section-description { font-size: 12px; display: none; }
            .progress-container { padding: 10px 16px; }
            .progress-label { font-size: 11px; margin-bottom: 6px; }
            .progress-bar { height: 4px; }
            .progress-steps { margin-top: 8px; }
            .progress-step { font-size: 0; }
            .step-dot { width: 8px; height: 8px; margin-bottom: 0; }
            .progress-step.active .step-dot { box-shadow: 0 0 0 2px rgba(255,255,255,0.3); }
            .main-content { padding: 12px; }
            .form-row { grid-template-columns: 1fr; }
            .page-navigation { flex-direction: column; gap: 12px; }
            .nav-btn { width: 100%; justify-content: center; }
            .section-card { margin-bottom: 12px; }
            .form-input, .form-select { padding: 10px 12px; font-size: 16px; }
            .risk-options { grid-template-columns: 1fr; }
        }
    </style>
    <script>
        (function() {
            let lastScrollTop = 0;
            let header = null;
            function initMobileHeader() {
                header = document.querySelector('.header');
                if (!header || window.innerWidth > 768) return;
                window.addEventListener('scroll', function() {
                    if (window.innerWidth > 768) { header.classList.remove('header-hidden'); return; }
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    if (scrollTop > lastScrollTop && scrollTop > 100) { header.classList.add('header-hidden'); }
                    else if (scrollTop < lastScrollTop - 10) { header.classList.remove('header-hidden'); }
                    lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
                }, { passive: true });
                window.addEventListener('resize', function() { if (window.innerWidth > 768) header.classList.remove('header-hidden'); });
            }
            if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initMobileHeader);
            else initMobileHeader();
        })();
    </script>
</head>
<body>
    <header class="header">
        <div class="header-top">
            <div class="logo">Evelyn Partners</div>
            <span class="type-badge" id="applicationTypeBadge">Individual</span>
        </div>
        <div class="header-main">
            <div class="journey-title">Fact Find A ‚Ä¢ Section 6 of 6</div>
            <h1 class="section-title">Risk Assessment & Review</h1>
            <p class="section-description">Complete your risk profile and review your information</p>
        </div>
        <div class="progress-container">
            <div class="progress-label">
                <span>Section Progress</span>
                <span id="progressPercent">0% Complete</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="progress-steps">
                <div class="progress-step active" data-section="1"><div class="step-dot"></div><span>Knowledge</span></div>
                <div class="progress-step" data-section="2"><div class="step-dot"></div><span>Risk Profile</span></div>
                <div class="progress-step" data-section="3"><div class="step-dot"></div><span>Banking</span></div>
                <div class="progress-step" data-section="4"><div class="step-dot"></div><span>Review</span></div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="save-status-bar">
            <div class="save-status">
                <div class="save-status-icon" id="saveStatusIcon"></div>
                <span id="saveStatusText">All changes saved</span>
            </div>
            <div style="display: flex; gap: 12px;">
                <button class="btn-save" onclick="saveProgress()">üíæ Save Progress</button>
            </div>
        </div>

        <!-- Section 23: Investment Knowledge Assessment -->
        <div class="section-card expanded" data-section="1" id="section1">
            <div class="section-header" onclick="toggleSection(1)">
                <div class="section-header-left">
                    <div class="section-number">23</div>
                    <div class="section-info">
                        <h3>Investment Knowledge Assessment</h3>
                        <p>Verify your understanding of investment concepts</p>
                    </div>
                </div>
                <div class="section-status">
                    <span class="status-badge pending" id="status1">Not started</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
            </div>
            <div class="section-content">
                <div class="applicant-toggle" id="applicantToggle1" style="display: none;">
                    <button class="applicant-btn active" onclick="switchApplicant(1, 1)">Primary Applicant</button>
                    <button class="applicant-btn" onclick="switchApplicant(1, 2)">Joint Applicant</button>
                </div>

                <div class="applicant-form active" id="applicant1Form1">
                    <div class="info-box">
                        <p>‚ÑπÔ∏è These questions help us understand your investment knowledge. There are no wrong answers - just be honest about your understanding.</p>
                    </div>

                    <div class="risk-question">
                        <h4>1. How would you describe your understanding of how stock markets work?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="q1_knowledge" value="1" onchange="handleFieldChange('q1_knowledge', '1')"><span>Very limited - I have little understanding</span></label>
                            <label class="risk-option"><input type="radio" name="q1_knowledge" value="2" onchange="handleFieldChange('q1_knowledge', '2')"><span>Basic - I understand the general concept</span></label>
                            <label class="risk-option"><input type="radio" name="q1_knowledge" value="3" onchange="handleFieldChange('q1_knowledge', '3')"><span>Good - I understand how prices move and why</span></label>
                            <label class="risk-option"><input type="radio" name="q1_knowledge" value="4" onchange="handleFieldChange('q1_knowledge', '4')"><span>Extensive - I have detailed knowledge of markets</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>2. Do you understand that past performance is not a guide to future performance?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="q2_knowledge" value="yes" onchange="handleFieldChange('q2_knowledge', 'yes')"><span>Yes, I understand this</span></label>
                            <label class="risk-option"><input type="radio" name="q2_knowledge" value="somewhat" onchange="handleFieldChange('q2_knowledge', 'somewhat')"><span>Somewhat - I'd like more explanation</span></label>
                            <label class="risk-option"><input type="radio" name="q2_knowledge" value="no" onchange="handleFieldChange('q2_knowledge', 'no')"><span>No, I don't fully understand this</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>3. Do you understand that investments can go down as well as up?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="q3_knowledge" value="yes" onchange="handleFieldChange('q3_knowledge', 'yes')"><span>Yes, I fully understand this risk</span></label>
                            <label class="risk-option"><input type="radio" name="q3_knowledge" value="somewhat" onchange="handleFieldChange('q3_knowledge', 'somewhat')"><span>Yes, but I'm concerned about losses</span></label>
                            <label class="risk-option"><input type="radio" name="q3_knowledge" value="no" onchange="handleFieldChange('q3_knowledge', 'no')"><span>I need more information about this</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>4. How do you prefer to make investment decisions?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="q4_knowledge" value="delegate" onchange="handleFieldChange('q4_knowledge', 'delegate')"><span>I prefer to delegate decisions to professionals</span></label>
                            <label class="risk-option"><input type="radio" name="q4_knowledge" value="consult" onchange="handleFieldChange('q4_knowledge', 'consult')"><span>I like to be consulted but trust expert advice</span></label>
                            <label class="risk-option"><input type="radio" name="q4_knowledge" value="involved" onchange="handleFieldChange('q4_knowledge', 'involved')"><span>I want to be actively involved in decisions</span></label>
                            <label class="risk-option"><input type="radio" name="q4_knowledge" value="self" onchange="handleFieldChange('q4_knowledge', 'self')"><span>I prefer to make my own decisions</span></label>
                        </div>
                    </div>
                </div>

                <div class="applicant-form" id="applicant2Form1">
                    <div class="form-group">
                        <label class="form-label">Investment Knowledge Level</label>
                        <select class="form-select" id="knowledge_customer2" onchange="handleFieldChange('knowledge_customer2', this.value)">
                            <option value="">Select</option>
                            <option value="limited">Limited</option>
                            <option value="basic">Basic</option>
                            <option value="good">Good</option>
                            <option value="extensive">Extensive</option>
                        </select>
                    </div>
                </div>

                <div class="section-actions">
                    <button class="btn btn-primary" onclick="completeSection(1)">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Section 24: Oxford Risk Assessment -->
        <div class="section-card" data-section="2" id="section2">
            <div class="section-header" onclick="toggleSection(2)">
                <div class="section-header-left">
                    <div class="section-number">24</div>
                    <div class="section-info">
                        <h3>Risk Profile Questionnaire</h3>
                        <p>Oxford Risk methodology assessment</p>
                    </div>
                </div>
                <div class="section-status">
                    <span class="status-badge pending" id="status2">Not started</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
            </div>
            <div class="section-content">
                <div class="applicant-toggle" id="applicantToggle2" style="display: none;">
                    <button class="applicant-btn active" onclick="switchApplicant(2, 1)">Primary Applicant</button>
                    <button class="applicant-btn" onclick="switchApplicant(2, 2)">Joint Applicant</button>
                </div>

                <div class="applicant-form active" id="applicant1Form2">
                    <div class="info-box">
                        <p>‚ÑπÔ∏è This questionnaire helps determine your risk profile. Answer based on how you genuinely feel, not how you think you should answer.</p>
                    </div>

                    <div class="risk-question">
                        <h4>1. Compared to others, how would you rate your willingness to take financial risks?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="oxford1" value="1" onchange="handleFieldChange('oxford1', '1')"><span>Much lower than average</span></label>
                            <label class="risk-option"><input type="radio" name="oxford1" value="2" onchange="handleFieldChange('oxford1', '2')"><span>Somewhat lower than average</span></label>
                            <label class="risk-option"><input type="radio" name="oxford1" value="3" onchange="handleFieldChange('oxford1', '3')"><span>Average</span></label>
                            <label class="risk-option"><input type="radio" name="oxford1" value="4" onchange="handleFieldChange('oxford1', '4')"><span>Somewhat higher than average</span></label>
                            <label class="risk-option"><input type="radio" name="oxford1" value="5" onchange="handleFieldChange('oxford1', '5')"><span>Much higher than average</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>2. How easily do you adapt when things go wrong financially?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="oxford2" value="1" onchange="handleFieldChange('oxford2', '1')"><span>Very difficult - I worry a lot</span></label>
                            <label class="risk-option"><input type="radio" name="oxford2" value="2" onchange="handleFieldChange('oxford2', '2')"><span>Somewhat difficult</span></label>
                            <label class="risk-option"><input type="radio" name="oxford2" value="3" onchange="handleFieldChange('oxford2', '3')"><span>Neither easy nor difficult</span></label>
                            <label class="risk-option"><input type="radio" name="oxford2" value="4" onchange="handleFieldChange('oxford2', '4')"><span>Somewhat easily</span></label>
                            <label class="risk-option"><input type="radio" name="oxford2" value="5" onchange="handleFieldChange('oxford2', '5')"><span>Very easily - I adapt quickly</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>3. When you think of the word "risk" in a financial context, which word comes to mind first?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="oxford3" value="1" onchange="handleFieldChange('oxford3', '1')"><span>Danger</span></label>
                            <label class="risk-option"><input type="radio" name="oxford3" value="2" onchange="handleFieldChange('oxford3', '2')"><span>Uncertainty</span></label>
                            <label class="risk-option"><input type="radio" name="oxford3" value="3" onchange="handleFieldChange('oxford3', '3')"><span>Opportunity</span></label>
                            <label class="risk-option"><input type="radio" name="oxford3" value="4" onchange="handleFieldChange('oxford3', '4')"><span>Thrill</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>4. How would you feel if your investments dropped by 20% in value over a year?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="oxford4" value="1" onchange="handleFieldChange('oxford4', '1')"><span>Very uncomfortable - would sell immediately</span></label>
                            <label class="risk-option"><input type="radio" name="oxford4" value="2" onchange="handleFieldChange('oxford4', '2')"><span>Uncomfortable - would consider selling</span></label>
                            <label class="risk-option"><input type="radio" name="oxford4" value="3" onchange="handleFieldChange('oxford4', '3')"><span>Somewhat uncomfortable but would hold</span></label>
                            <label class="risk-option"><input type="radio" name="oxford4" value="4" onchange="handleFieldChange('oxford4', '4')"><span>Unfazed - this is normal volatility</span></label>
                            <label class="risk-option"><input type="radio" name="oxford4" value="5" onchange="handleFieldChange('oxford4', '5')"><span>Would see it as a buying opportunity</span></label>
                        </div>
                    </div>

                    <div class="risk-question">
                        <h4>5. Have you ever invested a large sum in a risky investment mainly for the thrill?</h4>
                        <div class="risk-options">
                            <label class="risk-option"><input type="radio" name="oxford5" value="1" onchange="handleFieldChange('oxford5', '1')"><span>No, never</span></label>
                            <label class="risk-option"><input type="radio" name="oxford5" value="2" onchange="handleFieldChange('oxford5', '2')"><span>No, but I have considered it</span></label>
                            <label class="risk-option"><input type="radio" name="oxford5" value="3" onchange="handleFieldChange('oxford5', '3')"><span>Yes, occasionally</span></label>
                            <label class="risk-option"><input type="radio" name="oxford5" value="4" onchange="handleFieldChange('oxford5', '4')"><span>Yes, regularly</span></label>
                        </div>
                    </div>
                </div>

                <div class="applicant-form" id="applicant2Form2">
                    <p style="color: var(--gray-600); margin-bottom: 16px;">The joint applicant should also complete this risk assessment independently for accurate profiling.</p>
                    <div class="form-group">
                        <label class="form-label">Risk Tolerance Summary</label>
                        <select class="form-select" id="riskSummary_customer2" onchange="handleFieldChange('riskSummary_customer2', this.value)">
                            <option value="">Select</option>
                            <option value="conservative">Conservative</option>
                            <option value="moderate">Moderate</option>
                            <option value="balanced">Balanced</option>
                            <option value="growth">Growth</option>
                            <option value="aggressive">Aggressive</option>
                        </select>
                    </div>
                </div>

                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="goToSection(1)">‚Üê Previous</button>
                    <button class="btn btn-primary" onclick="completeSection(2)">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Section 25: Banking Details -->
        <div class="section-card" data-section="3" id="section3">
            <div class="section-header" onclick="toggleSection(3)">
                <div class="section-header-left">
                    <div class="section-number">25</div>
                    <div class="section-info">
                        <h3>Banking Details</h3>
                        <p>Nominated bank account for withdrawals</p>
                    </div>
                </div>
                <div class="section-status">
                    <span class="status-badge pending" id="status3">Not started</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
            </div>
            <div class="section-content">
                <div class="info-box">
                    <p>‚ÑπÔ∏è This bank account will be used for any withdrawals or income payments. For security, we can only make payments to accounts in your name.</p>
                </div>

                <div class="bank-card">
                    <div class="bank-icon">üè¶</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Bank Name <span class="required">*</span></label>
                            <input type="text" class="form-input" id="bankName" placeholder="e.g. Barclays, HSBC, Lloyds" onchange="handleFieldChange('bankName', this.value)">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Account Holder Name <span class="required">*</span></label>
                            <input type="text" class="form-input" id="accountName" placeholder="Name as shown on account" onchange="handleFieldChange('accountName', this.value)">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Sort Code <span class="required">*</span></label>
                            <input type="text" class="form-input" id="sortCode" placeholder="00-00-00" maxlength="8" onchange="handleFieldChange('sortCode', this.value)" oninput="formatSortCode(this)">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Account Number <span class="required">*</span></label>
                            <input type="text" class="form-input" id="accountNumber" placeholder="8 digits" maxlength="8" onchange="handleFieldChange('accountNumber', this.value)">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Building Society Roll Number (if applicable)</label>
                        <input type="text" class="form-input" id="rollNumber" placeholder="Only for building society accounts" onchange="handleFieldChange('rollNumber', this.value)">
                    </div>
                </div>

                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="goToSection(2)">‚Üê Previous</button>
                    <button class="btn btn-primary" onclick="completeSection(3)">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Section 26: Review & Submit -->
        <div class="section-card" data-section="4" id="section4">
            <div class="section-header" onclick="toggleSection(4)">
                <div class="section-header-left">
                    <div class="section-number">26</div>
                    <div class="section-info">
                        <h3>Review & Declaration</h3>
                        <p>Review your information and confirm submission</p>
                    </div>
                </div>
                <div class="section-status">
                    <span class="status-badge pending" id="status4">Not started</span>
                    <span class="toggle-icon">‚ñº</span>
                </div>
            </div>
            <div class="section-content">
                <div class="info-box">
                    <p>‚ÑπÔ∏è Please review all sections below. You can click 'Edit' to go back and make changes before submitting.</p>
                </div>

                <div id="reviewSummary">
                    <!-- Dynamically populated -->
                </div>

                <div class="declaration-section">
                    <h3>Declaration</h3>
                    <div class="declaration-text">
                        By submitting this Fact Find, I/we confirm that:
                    </div>
                    <div class="declaration-check">
                        <input type="checkbox" id="decl1" onchange="checkDeclarations()">
                        <label for="decl1">The information provided is accurate and complete to the best of my/our knowledge</label>
                    </div>
                    <div class="declaration-check">
                        <input type="checkbox" id="decl2" onchange="checkDeclarations()">
                        <label for="decl2">I/we will notify Evelyn Partners promptly of any material changes to this information</label>
                    </div>
                    <div class="declaration-check">
                        <input type="checkbox" id="decl3" onchange="checkDeclarations()">
                        <label for="decl3">I/we have read and understood the Terms and Conditions and Privacy Policy</label>
                    </div>
                    <div class="declaration-check">
                        <input type="checkbox" id="decl4" onchange="checkDeclarations()">
                        <label for="decl4">I/we consent to Evelyn Partners processing this information for the purposes stated</label>
                    </div>
                </div>

                <div class="section-actions">
                    <button class="btn btn-secondary" onclick="goToSection(3)">‚Üê Previous</button>
                    <button class="btn btn-success" id="submitBtn" disabled onclick="submitFactFind()">Submit Fact Find ‚úì</button>
                </div>
            </div>
        </div>

        <div class="completion-banner" id="completionBanner">
            <div class="completion-icon">üéâ</div>
            <h2>Fact Find Complete!</h2>
            <p>Your information has been saved successfully. You can now proceed to open an account.</p>
            <button class="nav-btn nav-btn-next" onclick="proceedToAccountOpening()">Open an Account ‚Üí</button>
        </div>

        <div class="page-navigation" id="pageNav">
            <a href="factfind_05_personal_circumstances.html" class="nav-btn nav-btn-prev">‚Üê Back to Personal Circumstances</a>
            <button class="nav-btn nav-btn-next" onclick="proceedToAccountOpening()" id="nextFormBtn" disabled>
                Proceed to Account Opening ‚Üí
            </button>
        </div>
    </main>

    <script>
        // =========================================
        // JURISDICTION CONFIGURATION
        // =========================================
        const JURISDICTION_CONFIG = {
            UK: { code: 'UK', currency: '¬£' },
            IE: { code: 'IE', currency: '‚Ç¨' }
        };
        
        const STORAGE_KEY = 'evelynFactFindRiskReview';
        const TOTAL_SECTIONS = 4;
        
        let formData = {};
        let sectionStatus = {};
        let isJointApplication = false;
        let currentJurisdiction = 'UK';
        let saveTimeout = null;

        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            isJointApplication = urlParams.get('type') === 'joint';
            
            // Get jurisdiction from URL or localStorage
            const urlJurisdiction = urlParams.get('jurisdiction');
            if (urlJurisdiction && JURISDICTION_CONFIG[urlJurisdiction]) {
                currentJurisdiction = urlJurisdiction;
            } else {
                const storedJurisdiction = localStorage.getItem('evelynJurisdiction');
                if (storedJurisdiction && JURISDICTION_CONFIG[storedJurisdiction]) {
                    currentJurisdiction = storedJurisdiction;
                }
            }
            
            // Store jurisdiction in form data
            formData.jurisdiction = currentJurisdiction;
            
            if (isJointApplication) {
                document.getElementById('applicationTypeBadge').textContent = 'Joint Application';
                document.querySelectorAll('.applicant-toggle').forEach(el => el.style.display = 'flex');
            }

            loadSavedData();
            for (let i = 1; i <= TOTAL_SECTIONS; i++) {
                if (!sectionStatus[i]) sectionStatus[i] = 'pending';
                updateSectionUI(i);
            }
            updateProgress();
            generateReviewSummary();
        });

        function loadSavedData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const parsed = JSON.parse(saved);
                formData = parsed.formData || {};
                sectionStatus = parsed.sectionStatus || {};
                Object.keys(formData).forEach(key => {
                    const value = formData[key];
                    
                    const el = document.getElementById(key);
                    if (el) {
                        if (el.type === 'checkbox') {
                            el.checked = value === true || value === 'true' || value === 'on';
                        } else {
                            el.value = value;
                        }
                    }
                    
                    // Also check for radio buttons by name
                    const radios = document.querySelectorAll(`input[type="radio"][name="${key}"]`);
                    if (radios.length > 0) {
                        radios.forEach(radio => {
                            if (radio.value === value) {
                                radio.checked = true;
                            }
                        });
                    }
                });
                
                restoreConditionalSections();
                updateSaveStatus('saved');
            }
        }
        
        function restoreConditionalSections() {
            // Restore risk-option visual selected state
            // Find all checked radio buttons and add 'selected' class to their parent risk-option
            document.querySelectorAll('.risk-option input[type="radio"]:checked').forEach(radio => {
                const parentOption = radio.closest('.risk-option');
                if (parentOption) parentOption.classList.add('selected');
            });
        }
        
        // Add click handler to risk-options for visual feedback
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.risk-option').forEach(option => {
                option.addEventListener('click', function() {
                    // Get the radio name to find siblings
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        const name = radio.name;
                        // Remove selected from all options with same name
                        document.querySelectorAll(`.risk-option input[name="${name}"]`).forEach(r => {
                            r.closest('.risk-option').classList.remove('selected');
                        });
                        // Add selected to this one
                        this.classList.add('selected');
                    }
                });
            });
        });

        function saveProgress() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify({ formData, sectionStatus, lastSaved: new Date().toISOString() }));
            updateSaveStatus('saved');
        }

        function handleFieldChange(fieldName, value) {
            formData[fieldName] = value;
            updateSaveStatus('saving');
            clearTimeout(saveTimeout);
            saveTimeout = setTimeout(() => saveProgress(), 500);
        }

        function updateSaveStatus(status) {
            const icon = document.getElementById('saveStatusIcon');
            const text = document.getElementById('saveStatusText');
            icon.className = 'save-status-icon';
            if (status === 'saved') { icon.classList.add('saved'); text.textContent = 'All changes saved'; }
            else if (status === 'saving') { icon.classList.add('saving'); text.textContent = 'Saving...'; }
        }

        // Scroll to section with offset to account for sticky header
        function scrollToSectionWithOffset(element) {
            const header = document.querySelector('.header');
            const headerHeight = header ? header.offsetHeight : 0;
            const offset = headerHeight + 20;
            const elementPosition = element.getBoundingClientRect().top;
            const currentScrollPosition = window.pageYOffset;
            const targetPosition = currentScrollPosition + elementPosition - offset;
            window.scrollTo({ top: targetPosition, behavior: 'smooth' });
        }

        function toggleSection(sectionNum) {
            const section = document.getElementById(`section${sectionNum}`);
            const wasExpanded = section.classList.contains('expanded');
            document.querySelectorAll('.section-card').forEach(card => card.classList.remove('expanded'));
            if (!wasExpanded) {
                section.classList.add('expanded');
                setTimeout(() => scrollToSectionWithOffset(section), 100);
            }
        }

        function goToSection(sectionNum) { toggleSection(sectionNum); }

        function completeSection(sectionNum) {
            sectionStatus[sectionNum] = 'completed';
            updateSectionUI(sectionNum);
            saveProgress();
            if (sectionNum < TOTAL_SECTIONS) {
                toggleSection(sectionNum + 1);
                if (sectionNum === 3) generateReviewSummary();
            }
            updateProgress();
        }

        function updateSectionUI(sectionNum) {
            const section = document.getElementById(`section${sectionNum}`);
            const statusBadge = document.getElementById(`status${sectionNum}`);
            const progressStep = document.querySelector(`.progress-step[data-section="${sectionNum}"]`);
            section.classList.remove('completed');
            progressStep.classList.remove('completed', 'active');
            if (sectionStatus[sectionNum] === 'completed') {
                section.classList.add('completed');
                statusBadge.className = 'status-badge completed';
                statusBadge.textContent = 'Completed';
                progressStep.classList.add('completed');
            } else {
                statusBadge.className = 'status-badge pending';
                statusBadge.textContent = 'Not started';
            }
        }

        function updateProgress() {
            const completed = Object.values(sectionStatus).filter(s => s === 'completed').length;
            const percent = Math.round((completed / TOTAL_SECTIONS) * 100);
            document.getElementById('progressFill').style.width = `${percent}%`;
            document.getElementById('progressPercent').textContent = `${percent}% Complete`;
        }

        function switchApplicant(sectionNum, applicantNum) {
            const toggle = document.getElementById(`applicantToggle${sectionNum}`);
            toggle.querySelectorAll('.applicant-btn').forEach((btn, i) => btn.classList.toggle('active', i + 1 === applicantNum));
            document.getElementById(`applicant1Form${sectionNum}`).classList.toggle('active', applicantNum === 1);
            document.getElementById(`applicant2Form${sectionNum}`).classList.toggle('active', applicantNum === 2);
        }

        function formatSortCode(input) {
            let value = input.value.replace(/[^0-9]/g, '');
            if (value.length > 2) value = value.slice(0,2) + '-' + value.slice(2);
            if (value.length > 5) value = value.slice(0,5) + '-' + value.slice(5);
            input.value = value.slice(0,8);
        }

        function generateReviewSummary() {
            const masterData = JSON.parse(localStorage.getItem('evelynFactFindMaster') || '{}');
            const container = document.getElementById('reviewSummary');
            
            const sections = [
                { key: 'personalInformation', name: 'Personal Information', link: 'factfind_01_personal_information.html' },
                { key: 'financialProfile', name: 'Financial Profile', link: 'factfind_02_financial_profile.html' },
                { key: 'investmentSuitability', name: 'Investment Suitability', link: 'factfind_03_investment_suitability.html' },
                { key: 'amlCompliance', name: 'AML & Compliance', link: 'factfind_04_aml_compliance.html' },
                { key: 'personalCircumstances', name: 'Personal Circumstances', link: 'factfind_05_personal_circumstances.html' }
            ];

            container.innerHTML = sections.map(section => {
                const isComplete = masterData[section.key]?.complete;
                return `
                    <div class="review-section">
                        <div class="review-header">
                            <span class="review-title">${section.name}</span>
                            <span class="review-status ${isComplete ? 'complete' : 'incomplete'}">
                                ${isComplete ? '‚úì Complete' : '‚óã Incomplete'}
                            </span>
                        </div>
                        <div class="review-content">
                            <a href="${section.link}" class="btn-edit">Edit Section ‚Üí</a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function checkDeclarations() {
            const allChecked = document.getElementById('decl1').checked &&
                             document.getElementById('decl2').checked &&
                             document.getElementById('decl3').checked &&
                             document.getElementById('decl4').checked;
            document.getElementById('submitBtn').disabled = !allChecked;
        }

        function submitFactFind() {
            // Complete the section
            sectionStatus[4] = 'completed';
            updateSectionUI(4);
            saveProgress();

            // Update master data
            const masterData = JSON.parse(localStorage.getItem('evelynFactFindMaster') || '{}');
            masterData.riskAssessment = { complete: true, timestamp: new Date().toISOString() };
            masterData.factFindComplete = true;
            masterData.jurisdiction = currentJurisdiction;
            masterData.submittedAt = new Date().toISOString();
            localStorage.setItem('evelynFactFindMaster', JSON.stringify(masterData));

            // Show completion banner
            document.getElementById('completionBanner').classList.add('visible');
            document.getElementById('pageNav').style.display = 'none';
            document.getElementById('nextFormBtn').disabled = false;

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function proceedToAccountOpening() {
            const type = isJointApplication ? 'joint' : 'individual';
            // Return to landing page where account cards are now unlocked
            window.location.href = `evelyn_landing_page.html?type=${type}&jurisdiction=${currentJurisdiction}`;
        }
    </script>
</body>
</html>
